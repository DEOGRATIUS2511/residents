{% extends 'base.html' %}
{% load static %}

{% block title %}Register Resident - Ward Management System{% endblock %}

{% block content %}
<div class="row justify-content-center">
  <div class="col-lg-10">
    <div class="card">
      <div class="card-header text-center">
        <h4 class="mb-0">Complete Registration</h4>
      </div>
      <div class="card-body">
        <form method="post" enctype="multipart/form-data">
          {% csrf_token %}

          {% if resident_form.errors or household_form.errors %}
          <div class="alert alert-danger" role="alert">
            <strong>There were problems with your submission.</strong>
            Please correct the highlighted fields below.
          </div>
          {% endif %}

          <div class="row g-4">
            <div class="col-md-5">
              <h6 class="mb-3">Household Information</h6>
              {{ household_form.non_field_errors }}
              <div class="mb-3">
                {{ household_form.household_number }}
                <div class="text-danger small">{{ household_form.household_number.errors }}</div>
              </div>
              <div class="mb-3">
                {{ household_form.street_name }}
                <div class="text-danger small">{{ household_form.street_name.errors }}</div>
              </div>
              <div class="mb-3">
                {{ household_form.house_number }}
                <div class="text-danger small">{{ household_form.house_number.errors }}</div>
              </div>
              <div class="mb-3">
                {{ household_form.ward }}
                <div class="text-danger small">{{ household_form.ward.errors }}</div>
              </div>
            </div>

            <div class="col-md-7">
              <h6 class="mb-3">Resident Information</h6>
              {{ resident_form.non_field_errors }}
              <div class="row g-3">
                <div class="col-md-4">
                  {{ resident_form.first_name }}
                  <div class="text-danger small">{{ resident_form.first_name.errors }}</div>
                </div>
                <div class="col-md-4">
                  {{ resident_form.middle_name }}
                  <div class="text-danger small">{{ resident_form.middle_name.errors }}</div>
                </div>
                <div class="col-md-4">
                  {{ resident_form.last_name }}
                  <div class="text-danger small">{{ resident_form.last_name.errors }}</div>
                </div>
                <div class="col-md-6">
                  {{ resident_form.nida_number }}
                  <div class="text-danger small">{{ resident_form.nida_number.errors }}</div>
                </div>
                <div class="col-md-6">
                  {{ resident_form.date_of_birth }}
                  <div class="text-danger small">{{ resident_form.date_of_birth.errors }}</div>
                </div>
                <div class="col-md-6">
                  {{ resident_form.place_of_birth }}
                  <div class="text-danger small">{{ resident_form.place_of_birth.errors }}</div>
                </div>
                <div class="col-md-3">
                  {{ resident_form.gender }}
                  <div class="text-danger small">{{ resident_form.gender.errors }}</div>
                </div>
                <div class="col-md-3">
                  {{ resident_form.marital_status }}
                  <div class="text-danger small">{{ resident_form.marital_status.errors }}</div>
                </div>
                <div class="col-md-6">
                  {{ resident_form.phone_number }}
                  <div class="text-danger small">{{ resident_form.phone_number.errors }}</div>
                </div>
                <div class="col-md-6">
                  {{ resident_form.email }}
                  <div class="text-danger small">{{ resident_form.email.errors }}</div>
                </div>
                <div class="col-md-6">
                  {{ resident_form.occupation }}
                  <div class="text-danger small">{{ resident_form.occupation.errors }}</div>
                </div>
                <div class="col-md-6">
                  {{ resident_form.education_level }}
                  <div class="text-danger small">{{ resident_form.education_level.errors }}</div>
                </div>
                <div class="col-md-6">
                  {{ resident_form.special_category }}
                  <div class="text-danger small">{{ resident_form.special_category.errors }}</div>
                </div>
                <div class="col-md-6">
                  {{ resident_form.relationship_to_head }}
                  <div class="text-danger small">{{ resident_form.relationship_to_head.errors }}</div>
                </div>
                <div class="col-md-12">
                  {{ resident_form.photo }}
                  <div class="text-danger small">{{ resident_form.photo.errors }}</div>
                </div>
              </div>
            </div>
          </div>

          {% if messages %}
            <div class="mt-3">
              {% for message in messages %}
                <div class="alert alert-{{ message.tags }} mb-2">{{ message }}</div>
              {% endfor %}
            </div>
          {% endif %}

          <div class="d-grid mt-4">
            <button type="submit" class="btn btn-primary">Register Resident</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
{% endblock %}
